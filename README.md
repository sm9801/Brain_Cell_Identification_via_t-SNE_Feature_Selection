# t-SNE 기반 뇌 세포 분류 및 비지도 학습 분석

## 개요
본 프로젝트는 고차원 유전자 발현 데이터를 활용하여  
**비지도 학습 및 준지도 학습 기법**으로 뇌 세포 유형을 분류합니다.

본 분석은 **MITx MicroMasters Statistics and Data Science** 과정의 연구 분석으로 수행되었습니다.

---

## 프로젝트 목표
- 고차원 유전자 발현 데이터 시각화  
- **3개의 주요 뇌 세포 유형** 식별  
- 각 세포 유형 내 **다수의 하위 세포 아형(sub-type)** 발견  
- 지도 학습을 활용한 특징 선택  
- **t-SNE 하이퍼파라미터**가 해석에 미치는 영향 분석  

---

## 1. 시각화 및 차원 축소

### PCA 분석
- 원본 데이터 PCA에서는 군집 구조가 명확하지 않음  
- 로그 변환을 통해 극단적인 유전자 발현값 보정  
- 변환된 데이터 PCA에서 **3개의 뚜렷한 군집** 관찰  

### 핵심 인사이트
PCA 자체는 군집화 기법이 아니지만,  
3개의 명확한 그룹은 **3개의 주요 뇌 세포 유형** 존재를 강하게 시사합니다.

---

## 2. 뇌 세포 군집화

### 주요 세포 유형
- PCA 결과에 **K-Means (k=3)** 적용  
- 각 군집이 명확히 분리됨  
- 3개의 상이한 뇌 세포 범주 확인  

### 하위 세포 아형 발견
- PCA 결과에 **t-SNE** 적용  
- KL-Divergence 최소화를 기준으로 파라미터 선택  
  - 차원 수: 2  
  - Perplexity: 약 40~50  
- t-SNE 시각화에서 **11개의 하위 군집** 확인  
- K-Means (k=11)으로 하위 아형 라벨링  

### 핵심 인사이트
각 주요 뇌 세포 유형은 여러 개의 세부적인 하위 아형으로 구성되어 있으며,  
이는 **계층적 세포 구조**를 뒷받침합니다.

---

## 3. 지도 학습을 활용한 특징 선택

### 로지스틱 회귀 설정
- K-Means 군집 라벨을 정답으로 사용  
- 원본 고차원 데이터 사용  
- 로그 변환 적용  
- 정규화 방식 비교:
  - L1 (Lasso)
  - L2 (Ridge)

### 모델 선택
| 정규화 방식 | 교차 검증 정확도 |
|------------|----------------|
| L1 | ~0.86 |
| **L2** | **~0.89** |

L2 정규화가 더 안정적이고 높은 성능을 보였습니다.

---

## 4. 유전자 특징 중요도 분석

### 특징 선택 방법
- 로지스틱 회귀 계수 기준 상위 **100개 유전자 선택**
- 다음 방법들과 성능 비교:
  - 회귀 계수 기반 선택
  - 분산 기반 선택
  - 무작위 선택

### 결과
| 특징 선택 방법 | 정확도 |
|---------------|--------|
| 회귀 계수 상위 100개 | **~0.93** |
| 분산 상위 100개 | ~0.92 |
| 무작위 선택 | ~0.36 |

### 핵심 인사이트
계수 기반 특징 선택은 분산 기반과 유사한 성능을 보이며,  
무작위 선택 대비 압도적으로 우수한 결과를 보였습니다.

---

## 5. 하이퍼파라미터 영향 분석

### PCA 차원 수 변화
- 10, 50, 100, 250, 500개 주성분 사용  
- 주성분 수 증가 시:
  - KL-Divergence 증가  
  - 군집 구조 해석 어려움 증가  

### t-SNE Perplexity
- 너무 낮거나 높은 값은 비효율적  
- 최적 범위: **10~50**

### t-SNE Learning Rate
- 최적 범위: **10~1000**
- 극단값에서는 군집 붕괴 또는 분산 발생  

### 로지스틱 회귀 정규화
- L2는 중요한 특징 유지  
- L1은 대부분의 계수를 0으로 제거  
- 본 데이터에서는 L2가 더 효과적  

---

## 사용 기술
- Python  
- NumPy  
- Pandas  
- Matplotlib  
- scikit-learn  
- statsmodels  

---

## 핵심 정리
- 유전자 발현 데이터에는 로그 변환이 필수  
- PCA + t-SNE 조합은 계층적 구조 시각화에 효과적  
- 뇌 세포는 명확한 하위 구조를 가짐  
- 특징 선택은 해석 가능성과 성능 모두에 중요  
- t-SNE는 하이퍼파라미터 튜닝이 핵심  

---
